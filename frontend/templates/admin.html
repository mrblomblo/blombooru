{% extends "base.html" %}

{% block title %}Admin Panel - {{ app_name }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-4 max-w-4xl">
    <div id="admin-panel">
        <!-- Header & Tab Navigation -->
        <div class="flex flex-col sm:flex-row sm:items-end justify-between border-b mb-6">
            <h1 class="text-lg font-bold py-2 sm:pb-3">{{ t('admin.title') }}</h1>

            <div class="flex w-full sm:w-auto">
                <button type="button"
                    class="tab-btn flex-1 sm:flex-none text-center px-6 py-2 text-sm font-bold border-b-2 border-transparent hover:text-primary transition-colors whitespace-nowrap"
                    data-tab="content">
                    {{ t('admin.tabs.content') }}
                </button>
                <button type="button"
                    class="tab-btn flex-1 sm:flex-none text-center px-6 py-2 text-sm font-bold border-b-2 border-transparent hover:text-primary transition-colors whitespace-nowrap"
                    data-tab="system">
                    {{ t('admin.tabs.system') }}
                </button>
                <button type="button"
                    class="tab-btn flex-1 sm:flex-none text-center px-6 py-2 text-sm font-bold border-b-2 border-transparent hover:text-primary transition-colors whitespace-nowrap"
                    data-tab="account">
                    {{ t('admin.tabs.account') }}
                </button>
            </div>
        </div>

        <!-- System Tab -->
        <div id="tab-system" class="tab-content hidden">
            <!-- Settings Section -->
            <div id="settings-section">
                <div class="surface p-2 sm:p-6 border mb-4">
                    <h2 class="text-base font-bold mb-4 pb-3 border-b">{{ t('admin.settings.title') }}</h2>

                    <form id="settings-form">
                        <div class="mb-4">
                            <label class="block text-xs font-bold mb-2">{{ t('admin.settings.app_name') }}</label>
                            <input type="text" id="app-name" name="app_name"
                                class="w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary">
                        </div>

                        <div class="mb-4">
                            <label class="block text-xs font-bold mb-2">{{ t('admin.settings.theme') }}</label>
                            <div id="theme-select" class="custom-select" data-value="">
                                <button
                                    class="custom-select-trigger w-full flex items-center justify-between gap-3 px-3 py-2 bg border text-xs cursor-pointer focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                    type="button">
                                    <span class="custom-select-value text-secondary">
                                        {{ t('admin.settings.loading_themes') }}
                                    </span>
                                    <svg class="custom-select-arrow flex-shrink-0 transition-transform duration-200 text-secondary"
                                        width="12" height="12" viewBox="0 0 12 12">
                                        <path fill="currentColor" d="M6 9L1 4h10z" />
                                    </svg>
                                </button>
                                <div
                                    class="custom-select-dropdown bg border border-primary max-h-60 overflow-y-auto shadow-lg">
                                </div>
                            </div>

                        </div>

                        <div class="mb-4">
                            <label class="block text-xs font-bold mb-2">{{ t('admin.settings.language') }}</label>
                            <div id="language-select" class="custom-select" data-value="{{ current_language() }}">
                                <button
                                    class="custom-select-trigger w-full flex items-center justify-between gap-3 px-3 py-2 bg border text-xs cursor-pointer focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                    type="button">
                                    <span class="custom-select-value text-secondary">
                                        {{ t('common.loading') }}
                                    </span>
                                    <svg class="custom-select-arrow flex-shrink-0 transition-transform duration-200 text-secondary"
                                        width="12" height="12" viewBox="0 0 12 12">
                                        <path fill="currentColor" d="M6 9L1 4h10z" />
                                    </svg>
                                </button>
                                <div
                                    class="custom-select-dropdown bg border border-primary max-h-60 overflow-y-auto shadow-lg">
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-xs font-bold mb-2">{{ t('admin.settings.items_per_page') }}</label>
                            <input type="number" id="items-per-page" name="items_per_page" min="20" max="200"
                                class="w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary">
                            <p class="text-xs text-secondary opacity-70 mt-1 ml-1">
                                {{ t('admin.settings.items_per_page_hint') }}
                            </p>
                        </div>

                        <div class="mb-4">
                            <label class="block text-xs font-bold mb-2">{{ t('admin.settings.external_share_url')
                                }}</label>
                            <input type="url" id="external-share-url" name="external_share_url"
                                placeholder="{{ t('admin.settings.external_share_url_placeholder') }}"
                                class="w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary">
                            <p class="text-xs text-secondary opacity-70 mt-1 ml-1">
                                {{ t('admin.settings.external_share_url_hint') }}
                            </p>
                        </div>
                        <div class="mb-4">
                            <label class="block text-xs font-bold mb-2">{{ t('admin.settings.default_sort') }}</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <div id="default-sort" class="custom-select w-full" data-value="uploaded_at">
                                        <button
                                            class="custom-select-trigger w-full flex items-center justify-between gap-3 px-3 py-2 bg border text-xs cursor-pointer focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                            type="button">
                                            <span class="custom-select-value">{{ t('admin.settings.upload_date')
                                                }}</span>
                                            <svg class="custom-select-arrow flex-shrink-0 transition-transform duration-200 text-secondary"
                                                width="12" height="12" viewBox="0 0 12 12">
                                                <path fill="currentColor" d="M6 9L1 4h10z" />
                                            </svg>
                                        </button>
                                        <div
                                            class="custom-select-dropdown bg border border-primary max-h-60 overflow-y-auto shadow-lg">
                                            <div class="custom-select-option px-3 py-2 cursor-pointer hover:surface text-xs"
                                                data-value="uploaded_at">{{ t('admin.settings.upload_date') }}</div>
                                            <div class="custom-select-option px-3 py-2 cursor-pointer hover:surface text-xs"
                                                data-value="filename">{{ t('admin.settings.file_name') }}</div>
                                            <div class="custom-select-option px-3 py-2 cursor-pointer hover:surface text-xs"
                                                data-value="file_size">{{ t('admin.settings.file_size') }}</div>
                                            <div class="custom-select-option px-3 py-2 cursor-pointer hover:surface text-xs"
                                                data-value="file_type">{{ t('admin.settings.file_type') }}</div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div id="default-order" class="custom-select w-full" data-value="desc">
                                        <button
                                            class="custom-select-trigger w-full flex items-center justify-between gap-3 px-3 py-2 bg border text-xs cursor-pointer focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                            type="button">
                                            <span class="custom-select-value">{{ t('admin.settings.descending')
                                                }}</span>
                                            <svg class="custom-select-arrow flex-shrink-0 transition-transform duration-200 text-secondary"
                                                width="12" height="12" viewBox="0 0 12 12">
                                                <path fill="currentColor" d="M6 9L1 4h10z" />
                                            </svg>
                                        </button>
                                        <div
                                            class="custom-select-dropdown bg border border-primary max-h-60 overflow-y-auto shadow-lg">
                                            <div class="custom-select-option px-3 py-2 cursor-pointer hover:surface text-xs"
                                                data-value="desc">{{ t('admin.settings.descending') }}</div>
                                            <div class="custom-select-option px-3 py-2 cursor-pointer hover:surface text-xs"
                                                data-value="asc">{{ t('admin.settings.ascending') }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-xs font-bold mb-2">{{ t('admin.settings.security') }}</label>
                            <div class="bg p-4 border">
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" id="require-auth" name="require_auth"
                                        class="w-4 h-4 accent-primary">
                                    <span class="text-xs">{{ t('admin.settings.require_auth') }}</span>
                                </label>
                                <p class="text-xs text-secondary opacity-70 mt-2 ml-6">
                                    {{ t('admin.settings.require_auth_hint') }}
                                </p>
                            </div>
                        </div>

                        <div class="mb-6">
                            <label class="block text-xs font-bold mb-2">{{ t('admin.caching.title') }}</label>
                            <div class="bg p-4 border">
                                <label class="flex items-center gap-2 cursor-pointer mb-4">
                                    <input type="checkbox" id="redis-enabled" name="redis_enabled"
                                        class="w-4 h-4 accent-primary">
                                    <span class="text-xs font-bold">{{ t('admin.caching.enable_redis') }}</span>
                                </label>

                                <div id="redis-settings-container" style="display: none;">
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                                        <div>
                                            <label
                                                class="block text-[10px] font-bold uppercase tracking-wider mb-1 opacity-70">
                                                {{ t('admin.caching.host') }}
                                            </label>
                                            <input type="text" id="redis-host"
                                                class="w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                                placeholder="localhost">
                                        </div>
                                        <div>
                                            <label
                                                class="block text-[10px] font-bold uppercase tracking-wider mb-1 opacity-70">
                                                {{ t('admin.caching.port') }}
                                            </label>
                                            <input type="number" id="redis-port"
                                                class="w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                                placeholder="6379">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                                        <div>
                                            <label
                                                class="block text-[10px] font-bold uppercase tracking-wider mb-1 opacity-70">
                                                {{ t('admin.caching.db_index') }}
                                            </label>
                                            <input type="number" id="redis-db"
                                                class="w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                                placeholder="0">
                                        </div>
                                        <div>
                                            <label
                                                class="block text-[10px] font-bold uppercase tracking-wider mb-1 opacity-70">
                                                {{ t('admin.caching.password') }}
                                            </label>
                                            <input type="password" id="redis-password"
                                                class="w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                                placeholder="{{ t('admin.caching.password_placeholder') }}">
                                        </div>
                                    </div>
                                    <button type="button" id="test-redis-btn"
                                        class="px-4 py-2 bg-primary primary-text transition-colors hover:bg-primary text-xs">
                                        {{ t('admin.caching.test_connection') }}
                                    </button>
                                    <div id="redis-test-result" class="mt-2 text-xs" style="display: none;"></div>
                                </div>
                            </div>
                        </div>

                        <button type="submit"
                            class="px-4 py-2 bg-primary primary-text transition-colors hover:bg-primary text-xs">
                            {{ t('admin.settings.save_settings') }}
                        </button>
                    </form>
                </div>

                <!-- API Access Section -->
                <div class="surface p-2 sm:p-6 border mb-4">
                    <h2 class="text-base font-bold mb-4 pb-3 border-b">{{ t('admin.api_access.title') }}</h2>

                    <p class="text-xs text-secondary mb-4">
                        {{ t('admin.api_access.description') }}
                    </p>

                    <div class="mb-6">
                        <button id="generate-api-key-btn"
                            class="px-4 py-2 bg-primary primary-text transition-colors hover:bg-primary text-xs">
                            {{ t('admin.api_access.generate_key') }}
                        </button>

                        <div id="new-api-key-display" style="display: none;"
                            class="mt-4 p-4 border border-primary bg bg-opacity-5">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-xs font-bold uppercase tracking-wider text-white">
                                    {{ t('admin.api_access.new_api_key') }}
                                </span>
                                <span class="text-[10px] bg-danger tag-text px-1.5 py-0.5 font-bold">
                                    {{ t('admin.api_access.shown_once') }}
                                </span>
                            </div>
                            <div class="flex gap-2">
                                <input type="text" id="new-api-key-value"
                                    class="w-full surface px-3 py-2 border text-xs font-mono hover:border-primary transition-colors focus:outline-none focus:border-primary"
                                    readonly>
                                <button id="copy-api-key-btn"
                                    class="px-4 py-2 bg-primary primary-text border text-xs hover:bg-primary transition-colors whitespace-nowrap">
                                    {{ t('admin.api_access.copy_key') }}
                                </button>
                            </div>
                            <p class="text-[10px] mt-2 opacity-70 italic font-bold">
                                {{ t('admin.api_access.store_securely') }}
                            </p>
                        </div>
                    </div>

                    <div id="api-keys-container">
                        <h3 class="text-sm font-bold mb-3">{{ t('admin.api_access.active_keys') }}</h3>
                        <div id="api-keys-list" class="border">
                            <!-- Keys will be populated here as rows -->
                            <div class="bg p-4 text-center text-xs text-secondary">
                                {{ t('admin.api_access.loading_keys') }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Backup & Restore Section -->
                <div class="surface p-2 sm:p-6 border mb-4">
                    <h2 class="text-base font-bold mb-4 pb-3 border-b">Backup & Restore</h2>

                    <div class="mb-4">
                        <h3 class="text-sm font-bold mb-3">{{ t('admin.backup.export_data') }}</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                            <a href="/api/admin/backup/tags"
                                class="block w-full text-center px-4 py-2 bg border transition-colors hover:border-primary text-xs">
                                {{ t('admin.backup.export_tags') }}
                            </a>
                            <a href="/api/admin/backup/media"
                                class="block w-full text-center px-4 py-2 bg border transition-colors hover:border-primary text-xs">
                                {{ t('admin.backup.export_media') }}
                            </a>
                            <a href="/api/admin/backup/full"
                                class="block w-full text-center px-4 py-2 bg-primary primary-text transition-colors hover:bg-primary text-xs">
                                {{ t('admin.backup.full_backup') }}
                            </a>
                        </div>
                    </div>

                    <div class="mb-4">
                        <h3 class="text-sm font-bold mb-3">{{ t('admin.backup.import_backup') }}</h3>
                        <div class="bg p-4 border block">
                            <p class="text-xs text-secondary mb-3">
                                {{ t('admin.backup.import_hint') }}<br>
                                {{ t('admin.backup.import_warning') }}<br>
                                <strong>{{ t('common.warning') }}:</strong> {{ t('admin.backup.import_time_warning') }}
                            </p>

                            <div id="full-import-area" class="upload-area">
                                <p class="text-xs">{{ t('admin.backup.drop_backup') }}</p>
                                <input type="file" id="full-import-input" accept=".zip" class="hidden">
                            </div>

                            <div id="full-import-status" style="display: none;" class="mt-3">
                                <div class="text-xs">
                                    <div id="full-import-progress"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- System Update Section -->
                <div class="surface p-2 sm:p-6 border mb-4">
                    <h2 class="text-base font-bold mb-4 pb-3 border-b">System Update</h2>
                    <p class="text-xs text-secondary mb-3">
                        {{ t('admin.update.update_warning') }} You can
                        find
                        them <a href="https://github.com/mrblomblo/blombooru/releases/latest" target="_blank"
                            class="text-primary transition-colors hover:text-primary">here</a>.<br>
                        <strong>{{ t('common.warning') }}:</strong> {{ t('admin.update.backup_warning') }}
                    </p>

                    <div id="update-initial-state">
                        <p class="text-xs text-secondary mb-3">
                            {{ t('admin.update.contact_github') }}
                        </p>
                        <button id="btn-check-updates"
                            class="px-4 py-2 bg-primary primary-text text-xs hover:bg-opacity-90 transition-colors">
                            {{ t('admin.update.check_updates') }}
                        </button>
                    </div>

                    <div id="update-loading" class="text-xs text-secondary mb-4 hidden">
                        {{ t('admin.update.checking') }}
                    </div>

                    <div id="update-status" style="display: none;">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                            <div>
                                <div class="text-xs text-secondary mb-1">{{ t('admin.update.current_version') }}</div>
                                <div class="text-sm font-bold font-mono" id="current-version-hash">...</div>
                                <div class="text-[10px] text-secondary" id="current-branch">...</div>
                            </div>
                            <div>
                                <div class="text-xs text-secondary mb-1">{{ t('admin.update.latest_version') }}</div>
                                <div class="text-sm font-bold font-mono" id="latest-version-hash">...</div>
                                <div class="text-[10px] text-secondary" id="latest-version-tag">...</div>
                            </div>
                        </div>

                        <div id="update-notices" class="mb-4 hidden"></div>

                        <div class="flex gap-3 mb-4">
                            <button id="btn-update-dev"
                                class="px-4 py-2 bg-primary primary-text text-xs hover:bg-opacity-90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                                {{ t('admin.update.update_dev') }}
                            </button>
                            <button id="btn-update-stable"
                                class="px-4 py-2 surface border text-xs hover:border-primary transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                                {{ t('admin.update.update_stable') }}
                            </button>
                            <button id="btn-view-changelog" style="display: none;"
                                class="px-4 py-2 surface border text-xs hover:border-primary transition-colors">
                                {{ t('admin.update.view_changelog') }}
                            </button>
                        </div>
                    </div>

                    <div id="update-result" class="mt-4 hidden">
                        <h3 class="text-xs font-bold mb-2" id="update-result-title">{{ t('admin.update.update_output')
                            }}</h3>
                        <pre class="bg-black bg-opacity-20 p-2 border max-h-60 overflow-y-auto font-mono text-[10px] whitespace-pre-wrap"
                            id="update-result-log"></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Tab -->
        <div id="tab-content" class="tab-content hidden">
            <!-- Media Management Section -->
            <div class="surface p-2 sm:p-6 border mb-4">
                <h2 class="text-base font-bold mb-4 pb-3 border-b">{{ t('admin.media_management.title') }}</h2>
                <div id="media-stats" class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4">
                    <div class="bg p-3 border">
                        <div class="text-xs text-secondary">{{ t('admin.media_management.total_media') }}</div>
                        <div class="text-lg font-bold" id="total-media">0</div>
                    </div>
                    <div class="bg p-3 border">
                        <div class="text-xs text-secondary">{{ t('admin.media_management.total_images') }}</div>
                        <div class="text-lg font-bold" id="total-images">0</div>
                    </div>
                    <div class="bg p-3 border">
                        <div class="text-xs text-secondary">{{ t('admin.media_management.total_gifs') }}</div>
                        <div class="text-lg font-bold" id="total-gifs">0</div>
                    </div>
                    <div class="bg p-3 border">
                        <div class="text-xs text-secondary">{{ t('admin.media_management.total_videos') }}</div>
                        <div class="text-lg font-bold" id="total-videos">0</div>
                    </div>
                </div>

                <div class="mb-4">
                    <h3 class="text-sm font-bold mb-3">{{ t('admin.media_management.upload_media') }}</h3>
                    <div class="bg p-4 border">
                        <p class="text-xs text-secondary mb-3">
                            {{ t('admin.media_management.upload_hint') }}<br>
                            {{ t('admin.media_management.supported_images') }}<br>
                            {{ t('admin.media_management.supported_videos') }}<br>
                            {{ t('admin.media_management.max_file_size') }}<br>
                            {{ t('admin.media_management.archive_hint') }}
                        </p>
                        <button id="scan-media-btn"
                            class="px-4 py-2 w-full bg-primary primary-text transition-colors hover:bg-primary text-xs mb-4">{{
                            t('admin.media_management.scan_untracked') }}</button>
                        <div id="upload-area" class="upload-area">
                            <p class="text-xs">{{ t('admin.media_management.drop_media') }}</p>
                            <input type="file" id="file-input" multiple accept="image/*,video/*,.zip,.tar.gz,.tgz">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tags Management Section -->
            <div class="surface p-2 sm:p-6 border mb-4">
                <h2 class="text-base font-bold mb-4 pb-3 border-b">{{ t('admin.tags_management.title') }}</h2>

                <div id="tag-stats" class="grid grid-cols-1 sm:grid-cols-3 gap-3 mb-4">
                    <div class="bg p-3 border">
                        <div class="text-xs text-secondary">{{ t('admin.tags_management.total_tags') }}</div>
                        <div class="text-lg font-bold" id="total-tags">0</div>
                    </div>
                    <div class="bg p-3 border">
                        <div class="text-xs text-secondary">{{ t('admin.tags_management.tag_aliases') }}</div>
                        <div class="text-lg font-bold" id="total-aliases">0</div>
                    </div>
                    <div class="bg p-3 border">
                        <div class="text-xs text-secondary">{{ t('admin.tags_management.categories') }}</div>
                        <div class="text-lg font-bold" id="total-categories">5</div>
                    </div>
                </div>

                <div class="mb-4">
                    <h3 class="text-sm font-bold mb-3">{{ t('admin.tags_management.import_csv') }}</h3>
                    <div class="bg p-4 border">
                        <p class="text-xs text-secondary mb-3">
                            {{ t('admin.tags_management.csv_format') }}<br>
                            <code class="surface">
                                {{ t('admin.tags_management.csv_example') }}
                            </code><br>
                            {{ t('admin.tags_management.csv_categories') }}
                        </p>

                        <div id="csv-upload-area" class="upload-area">
                            <p class="text-xs">{{ t('admin.tags_management.drop_csv') }}</p>
                            <input type="file" id="csv-file-input" accept=".csv" class="hidden">
                        </div>

                        <div id="csv-import-status" style="display: none;" class="mt-3">
                            <div class="text-xs">
                                <div id="csv-import-progress"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <h3 class="text-sm font-bold mb-3">{{ t('admin.tags_management.add_tags') }}</h3>
                    <div class="bg p-4 border">
                        <p class="text-xs text-secondary mb-3">
                            {{ t('admin.tags_management.add_tags_hint') }}<br>
                            <code class="surface">artist:&lt;tag&gt;</code>,
                            <code class="surface">copyright:&lt;tag&gt;</code>,
                            <code class="surface">character:&lt;tag&gt;</code>,
                            <code class="surface">meta:&lt;tag&gt;</code><br>
                            {{ t('admin.tags_management.tags_without_prefix') }}<br>
                            {{ t('admin.tags_management.tags_exist_hint') }}
                        </p>

                        <form id="add-tags-form">
                            <label class="block text-xs font-bold mb-2">{{ t('admin.tags_management.tags_to_add')
                                }}</label>
                            <div style="position: relative;">
                                <div id="new-tags-input" contenteditable="true"
                                    data-placeholder="artist:bingus character:herbert meta:ai-generated copyright:original cool_tag"
                                    class="w-full bg px-3 py-2 border text-xs mb-3 focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                    style="min-height: 1.5rem; white-space: pre-wrap; overflow-wrap: break-word;"></div>
                            </div>
                            <button type="submit"
                                class="w-full px-4 py-2 bg-primary primary-text transition-colors hover:bg-primary text-xs">
                                {{ t('admin.tags_management.add_tags') }}
                            </button>
                        </form>

                        <div id="add-tags-status" style="display: none;" class="mt-3">
                            <div class="text-xs">
                                <div id="add-tags-result"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <h3 class="text-sm font-bold mb-3">Search & Delete Tags</h3>
                    <div class="flex gap-2 mb-3">
                        <div class="relative w-full">
                            <input type="text" id="tag-search-input"
                                placeholder="{{ t('admin.tags_management.search_tags_placeholder') }}"
                                class="flex-1 w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary">
                        </div>
                        <button id="tag-search-btn"
                            class="px-4 py-2 bg-primary primary-text transition-colors hover:bg-primary text-xs">
                            {{ t('common.search') }}
                        </button>
                    </div>
                    <div id="tag-search-results" class="max-h-64 overflow-y-auto"></div>
                </div>

                <div class="border-t pt-4">
                    <h3 class="text-sm font-bold mb-3 text-danger">{{ t('admin.tags_management.danger_zone') }}</h3>
                    <button id="clear-tags-btn"
                        class="px-4 py-2 bg-danger transition-colors hover:bg-danger tag-text text-xs">
                        {{ t('admin.tags_management.delete_all_tags') }}
                    </button>
                </div>
            </div>

            <!-- Albums Management Section -->
            <div class="surface p-2 sm:p-6 border mb-4">
                <h2 class="text-base font-bold mb-4 pb-3 border-b">{{ t('admin.albums_management.title') }}</h2>

                <div id="album-stats" class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4">
                    <div class="bg p-3 border">
                        <div class="text-xs text-secondary">{{ t('admin.albums_management.total_albums') }}</div>
                        <div class="text-lg font-bold" id="total-albums">0</div>
                    </div>
                    <div class="bg p-3 border">
                        <div class="text-xs text-secondary">{{ t('admin.albums_management.root_albums') }}</div>
                        <div class="text-lg font-bold" id="root-albums">0</div>
                    </div>
                </div>

                <div class="mb-4">
                    <h3 class="text-sm font-bold mb-3">{{ t('admin.albums_management.create_album') }}</h3>
                    <div class="bg p-4 border">
                        <form id="create-album-form">
                            <div class="mb-3">
                                <label class="block text-xs font-bold mb-2">{{ t('admin.albums_management.album_name')
                                    }}</label>
                                <input type="text" id="album-name-input" required
                                    class="w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                    placeholder="{{ t('admin.albums_management.album_name_placeholder') }}">
                            </div>

                            <div class="mb-3" id="parent-album-container">
                                <label class="block text-xs font-bold mb-2">{{ t('admin.albums_management.parent_album')
                                    }}</label>
                                <div id="parent-album-select" class="custom-select" data-value="">
                                    <button
                                        class="custom-select-trigger w-full flex items-center justify-between gap-3 px-3 py-2 bg border text-xs cursor-pointer focus:outline-none hover:border-primary transition-colors focus:border-primary"
                                        type="button">
                                        <span class="custom-select-value text-secondary">
                                            {{ t('admin.albums_management.none_root') }}
                                        </span>
                                        <svg class="custom-select-arrow flex-shrink-0 transition-transform duration-200 text-secondary"
                                            width="12" height="12" viewBox="0 0 12 12">
                                            <path fill="currentColor" d="M6 9L1 4h10z" />
                                        </svg>
                                    </button>
                                    <div
                                        class="custom-select-dropdown bg border border-primary max-h-60 overflow-y-auto shadow-lg">
                                        <div class="custom-select-option px-3 py-2 cursor-pointer hover:surface text-xs selected"
                                            data-value="">{{ t('admin.albums_management.none_root') }}</div>
                                    </div>
                                </div>
                            </div>

                            <button type="submit"
                                class="w-full px-4 py-2 bg-primary primary-text transition-colors hover:bg-primary text-xs">
                                {{ t('admin.albums_management.create_album') }}
                            </button>
                        </form>
                    </div>
                </div>

                <div class="mb-4">
                    <h3 class="text-sm font-bold mb-3">Search & Manage Albums</h3>
                    <div class="flex gap-2 mb-3">
                        <div class="w-full">
                            <input type="text" id="album-search-input"
                                placeholder="{{ t('admin.albums_management.search_albums_placeholder') }}"
                                class="flex-1 w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary">
                        </div>
                        <button id="album-search-btn"
                            class="px-4 py-2 bg-primary primary-text transition-colors hover:bg-primary text-xs">Search</button>
                    </div>
                    <div id="album-search-results" class="max-h-96 overflow-y-auto"></div>
                </div>
            </div>
        </div>

        <!-- Account Tab -->
        <div id="tab-account" class="tab-content hidden">
            <!-- Admin Account Management Section -->
            <div class="surface p-2 sm:p-6 border">
                <h2 class="text-base font-bold mb-4 pb-3 border-b">{{ t('admin.account.title') }}</h2>

                <div class="mb-4">
                    <form id="change-admin-password-form">
                        <div class="mb-4">
                            <label class="block text-xs font-bold mb-2">{{ t('admin.account.new_password') }}</label>
                            <input type="password" id="new-admin-password" required minlength="6" maxlength="50"
                                placeholder="{{ t('admin.account.password_placeholder') }}"
                                class="w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary">
                            <small class="text-secondary text-xs">{{ t('admin.account.password_hint') }}</small>
                        </div>

                        <button type="submit"
                            class="px-4 py-2 bg-primary primary-text transition-colors hover:bg-primary text-xs">
                            {{ t('admin.account.change_password') }}
                        </button>
                    </form>

                    <div id="change-password-status" style="display: none;" class="mt-3">
                        <div class="text-xs">
                            <div id="change-password-result"></div>
                        </div>
                    </div>
                </div>

                <form id="change-admin-username-form" class="mt-6">
                    <div class="mb-4">
                        <label class="block text-xs font-bold mb-2">{{ t('admin.account.new_username') }}</label>
                        <input type="text" id="new-admin-username" required
                            placeholder="{{ t('admin.account.username_placeholder') }}"
                            class="w-full bg px-3 py-2 border text-xs focus:outline-none hover:border-primary transition-colors focus:border-primary">
                    </div>

                    <button type="submit"
                        class="px-4 py-2 bg-primary primary-text transition-colors hover:bg-primary text-xs">
                        {{ t('admin.account.change_username') }}
                    </button>
                </form>

                <div id="change-username-status" style="display: none;" class="mt-3">
                    <div class="text-xs">
                        <div id="change-username-result"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/fullscreen-mediaviewer.js?v={{ app_version }}"></script>
<script src="/static/js/tag-input-helper.js?v={{ app_version }}"></script>
<script src="/static/js/custom-select.js?v={{ app_version }}"></script>
<script src="/static/js/admin.js?v={{ app_version }}"></script>
<script src="/static/js/upload.js?v={{ app_version }}"></script>
{% endblock %}

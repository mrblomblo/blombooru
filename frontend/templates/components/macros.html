{# Rating Filter Component #}
{% macro rating_filter(location='desktop') %}
{% if location == 'mobile' %}
<div class="surface p-3 mb-4 border block lg:hidden">
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-2">
        {{ _rating_options('py-2') }}
    </div>
</div>
{% else %}
<div class="hidden lg:block mb-4">
    <h3 class="text-sm font-bold mb-3 pb-1 border-b">Rating Filter</h3>
    <div class="grid grid-cols-1 gap-2 mb-3">
        {{ _rating_options('py-1') }}
    </div>
</div>
{% endif %}
{% endmacro %}

{% macro _rating_options(padding='py-1') %}
{% for rating in ['safe', 'questionable', 'explicit'] %}
<label class="flex-1">
    <input type="radio" name="rating" value="{{ rating }}" class="hidden rating-filter-input">
    <span
        class="block text-center px-3 {{ padding }} border-1 cursor-pointer bg hover:border-primary transition-colors rating-filter-label">
        {{ rating|capitalize }}
    </span>
</label>
{% endfor %}
{% endmacro %}

{# Standard Sort Options - used across all pages #}
{% set standard_sort_options = {
'uploaded_at': 'Upload Date',
'filename': 'File Name',
'file_size': 'File Size',
'file_type': 'File Type'
} %}

{# Sorting Options Component #}
{% macro sorting_options(sort_options=none, default_sort='uploaded_at', default_order='desc', show_wrapper=true) %}
{% set options = sort_options if sort_options else standard_sort_options %}
{% if show_wrapper %}
<div class="hidden lg:block mb-4">
    <h3 class="text-sm font-bold mb-3 pb-1 border-b">Sort By</h3>
    {% endif %}
    <div class="mb-3">
        <div id="sort-by-select" class="custom-select w-full mb-2" data-value="{{ default_sort }}">
            <button
                class="custom-select-trigger w-full flex items-center justify-between gap-3 px-2 py-1 bg border text-xs cursor-pointer hover:border-primary focus:outline-none focus:border-primary transition-colors"
                type="button">
                <span class="custom-select-value">{{ options[default_sort] if default_sort in options else
                    options.values()|first }}</span>
                {{ _select_arrow() }}
            </button>
            <div class="custom-select-dropdown bg border border-primary max-h-60 overflow-y-auto shadow-lg">
                {% for value, label in options.items() %}
                <div class="custom-select-option px-3 py-2 cursor-pointer hover:surface text-xs transition-colors"
                    data-value="{{ value }}">{{ label }}</div>
                {% endfor %}
            </div>
        </div>

        <div id="sort-order-select" class="custom-select w-full" data-value="{{ default_order }}">
            <button
                class="custom-select-trigger w-full flex items-center justify-between gap-3 px-2 py-1 bg border text-xs cursor-pointer hover:border-primary focus:outline-none focus:border-primary transition-colors"
                type="button">
                <span class="custom-select-value">{{ 'Descending' if default_order == 'desc' else 'Ascending' }}</span>
                {{ _select_arrow() }}
            </button>
            <div class="custom-select-dropdown bg border border-primary max-h-60 overflow-y-auto shadow-lg">
                <div class="custom-select-option px-3 py-2 cursor-pointer hover:surface text-xs transition-colors"
                    data-value="desc">
                    Descending
                </div>
                <div class="custom-select-option px-3 py-2 cursor-pointer hover:surface text-xs transition-colors"
                    data-value="asc">
                    Ascending
                </div>
            </div>
        </div>
    </div>
    {% if show_wrapper %}
</div>
{% endif %}
{% endmacro %}

{% macro _select_arrow() %}
<svg class="custom-select-arrow flex-shrink-0 transition-transform duration-200 text-secondary" width="12" height="12"
    viewBox="0 0 12 12">
    <path fill="currentColor" d="M6 9L1 4h10z" />
</svg>
{% endmacro %}

{# Bulk Actions Component #}
{% macro bulk_actions(buttons=['select_all', 'deselect_all', 'delete']) %}
<div id="bulk-actions" style="display: none;" class="surface p-3 mb-4 border">
    <p class="mb-2"><span id="selected-count">0</span> items selected</p>
    <div class="flex gap-2 flex-wrap">
        {% if 'select_all' in buttons %}
        <button id="select-all-btn" class="px-3 py-1 bg-primary transition-colors hover:bg-primary tag-text text-xs">
            Select All
        </button>
        {% endif %}
        {% if 'deselect_all' in buttons %}
        <button id="deselect-all-btn"
            class="px-3 py-1 surface-light transition-colors hover:surface-light text text-xs">
            Deselect All
        </button>
        {% endif %}
        {% if 'album' in buttons %}
        <button id="bulk-album-btn" class="px-3 py-1 surface-light transition-colors hover:surface-light text text-xs">
            Add to Albums
        </button>
        {% endif %}
        {% if 'ai_tags' in buttons %}
        <button id="bulk-ai-tags-btn"
            class="px-3 py-1 surface-light transition-colors hover:surface-light text text-xs">
            Bulk Append AI Tags
        </button>
        {% endif %}
        {% if 'wd_tagger' in buttons %}
        <button id="bulk-wd-tagger-btn"
            class="px-3 py-1 surface-light transition-colors hover:surface-light text text-xs">
            Bulk AI Predict Tags
        </button>
        {% endif %}
        {% if 'remove' in buttons %}
        <button id="bulk-remove-btn" class="px-3 py-1 bg-danger transition-colors hover:bg-danger tag-text text-xs">
            Remove from Album
        </button>
        {% endif %}
        {% if 'delete' in buttons %}
        <button id="bulk-delete-btn" class="px-3 py-1 bg-danger transition-colors hover:bg-danger tag-text text-xs">
            Delete Selected
        </button>
        {% endif %}
    </div>
</div>
{% endmacro %}

{# Page Jump Modal #}
{% macro page_jump_modal() %}
<div id="page-jump-modal" class="modal" style="display: none;">
    <div class="modal-content surface border p-4" style="max-width: 300px;">
        <h3 class="text-sm font-bold mb-3">Jump to Page</h3>
        <input type="number" id="page-jump-input" min="1"
            class="w-full bg px-3 py-2 border text-xs mb-3 focus:outline-none focus:border-primary">
        <div class="flex gap-2">
            <button id="page-jump-go"
                class="flex-1 px-3 py-2 bg-primary primary-text hover:bg-primary text-xs">Go</button>
            <button id="page-jump-cancel" class="flex-1 px-3 py-2 border hover:surface text-xs">Cancel</button>
        </div>
    </div>
</div>
{% endmacro %}

{# Loading Indicator #}
{% macro loading_indicator() %}
<div id="loading-indicator" class="text-center py-8">
    <div class="spinner"></div>
    <p class="text-secondary mt-2">Loading...</p>
</div>
{% endmacro %}

{# Page Navigation #}
{% macro page_navigation(id='page-nav') %}
<div id="{{ id }}" class="surface p-3 mt-4 border" style="display: none;">
    <div class="flex items-center justify-center gap-2 text-xs flex-wrap"></div>
</div>
{% endmacro %}

{# Popular Tags Sidebar Section #}
{% macro popular_tags_section() %}
<h3 class="text-sm font-bold mb-2 pb-1 border-b">Popular Tags</h3>
<div id="popular-tags" class="text-xs">
    <p class="text-secondary">Loading...</p>
</div>
{% endmacro %}

{# Sidebar Container #}
{% macro sidebar_start() %}
<div class="xl:col-span-1 lg:col-span-1">
    <div class="surface p-3 border sticky top-4">
        {% endmacro %}

        {% macro sidebar_end() %}
    </div>
</div>
{% endmacro %}
